<!DOCTYPE html>
<html lang="uz" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MathZone — Matematika ta'lim platformasi</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen" class="loading-screen">
        <div class="loader-content">
            <div class="loader-logo">
                <span class="logo-math">Math</span><span class="logo-zone">Zone</span>
            </div>
            <div class="loader-spinner"></div>
            <p class="loader-text">Yuklanmoqda...</p>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toast-container" class="toast-container"></div>

    <!-- Confirm Modal -->
    <div id="confirm-modal" class="modal-overlay hidden">
        <div class="modal-box confirm-box">
            <div class="modal-icon"><i class="fas fa-question-circle"></i></div>
            <h3 id="confirm-title">Tasdiqlash</h3>
            <p id="confirm-message">Ishonchingiz komilmi?</p>
            <div class="modal-actions">
                <button class="btn btn-secondary" id="confirm-cancel">Bekor qilish</button>
                <button class="btn btn-primary" id="confirm-ok">Ha, tasdiqlash</button>
            </div>
        </div>
    </div>

    <!-- QR Modal -->
    <div id="qr-modal" class="modal-overlay hidden">
        <div class="modal-box qr-box">
            <button class="modal-close" onclick="closeModal('qr-modal')">&times;</button>
            <h3>QR Kod</h3>
            <div id="qr-display" class="qr-display"></div>
            <p id="qr-link" class="qr-link"></p>
            <button class="btn btn-primary" id="qr-copy-btn"><i class="fas fa-copy"></i> Nusxa olish</button>
        </div>
    </div>

    <!-- ==================== LANDING PAGE ==================== -->
    <div id="page-landing" class="page active">
        <div class="landing-bg">
            <div class="floating-symbols">
                <span class="float-sym sym1">∑</span>
                <span class="float-sym sym2">π</span>
                <span class="float-sym sym3">∞</span>
                <span class="float-sym sym4">√</span>
                <span class="float-sym sym5">∫</span>
                <span class="float-sym sym6">Δ</span>
                <span class="float-sym sym7">θ</span>
                <span class="float-sym sym8">α</span>
                <span class="float-sym sym9">∂</span>
                <span class="float-sym sym10">λ</span>
            </div>
        </div>

        <nav class="landing-nav">
            <div class="nav-logo">
                <i class="fas fa-square-root-variable"></i>
                <span>Math<strong>Zone</strong></span>
            </div>
            <div class="nav-actions">
                <button class="btn btn-secondary btn-sm" id="btn-theme-landing" onclick="toggleTheme()">
                    <i class="fas fa-moon"></i>
                </button>
                <button class="btn btn-secondary" onclick="showAuth('login')">Kirish</button>
                <button class="btn btn-primary" onclick="showAuth('register')">Ro'yxatdan o'tish</button>
            </div>
        </nav>

        <section class="hero">
            <div class="hero-content">
                <div class="hero-badge">
                    <i class="fas fa-rocket"></i> #1 Matematika platformasi
                </div>
                <h1 class="hero-title">
                    <span class="gradient-text">Matematika</span> — kelajak kaliti
                </h1>
                <p class="hero-subtitle">
                    Testlar yarating, bilimingizni sinang, reyting oling. 
                    O'qituvchilar va o'quvchilar uchun mukammal platforma.
                </p>
                <div class="hero-buttons">
                    <button class="btn btn-primary btn-lg" onclick="showAuth('register')">
                        <i class="fas fa-arrow-right"></i> Boshlash
                    </button>
                    <button class="btn btn-glass btn-lg" onclick="document.getElementById('features').scrollIntoView({behavior:'smooth'})">
                        <i class="fas fa-play"></i> Batafsil
                    </button>
                </div>
                <div class="hero-stats">
                    <div class="hero-stat">
                        <span class="hero-stat-num">1000+</span>
                        <span class="hero-stat-label">Testlar</span>
                    </div>
                    <div class="hero-stat">
                        <span class="hero-stat-num">500+</span>
                        <span class="hero-stat-label">O'quvchilar</span>
                    </div>
                    <div class="hero-stat">
                        <span class="hero-stat-num">50+</span>
                        <span class="hero-stat-label">O'qituvchilar</span>
                    </div>
                </div>
            </div>
        </section>

        <section class="features" id="features">
            <h2 class="section-title">Platformaning imkoniyatlari</h2>
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon" style="--clr:#6C63FF"><i class="fas fa-file-pdf"></i></div>
                    <h3>PDF Test</h3>
                    <p>PDF yuklang yoki onlayn test yarating. LaTeX formulalar qo'llab-quvvatlanadi.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon" style="--clr:#3B82F6"><i class="fas fa-clock"></i></div>
                    <h3>Timer & Nazorat</h3>
                    <p>Vaqt chegarasi, fullscreen rejim, tab nazorati — ko'chirish imkonsiz.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon" style="--clr:#10B981"><i class="fas fa-chart-line"></i></div>
                    <h3>Analitika</h3>
                    <p>Har bir o'quvchining kuchli va kuchsiz tomonlarini aniqlang.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon" style="--clr:#F59E0B"><i class="fas fa-trophy"></i></div>
                    <h3>Gamifikatsiya</h3>
                    <p>XP, darajalar, yutuqlar, streak — o'qishni o'yinga aylantiring.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon" style="--clr:#EF4444"><i class="fas fa-users"></i></div>
                    <h3>Sinf boshqaruvi</h3>
                    <p>Sinflar yarating, QR kod bilan o'quvchilarni qo'shing.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon" style="--clr:#8B5CF6"><i class="fas fa-mobile-alt"></i></div>
                    <h3>Mobil qulay</h3>
                    <p>Telefondan mukammal ishlaydi. Istalgan vaqtda, istalgan joyda.</p>
                </div>
            </div>
        </section>

        <footer class="landing-footer">
            <p>&copy; 2026 MathZone. Barcha huquqlar himoyalangan.</p>
        </footer>
    </div>

    <!-- ==================== AUTH MODAL ==================== -->
    <div id="modal-auth" class="modal-overlay hidden">
        <div class="modal-box auth-box">
            <button class="modal-close" onclick="closeModal('modal-auth')">&times;</button>
            <div class="auth-header">
                <i class="fas fa-square-root-variable auth-logo-icon"></i>
                <h2>Math<strong>Zone</strong></h2>
            </div>
            <div class="auth-tabs">
                <button class="auth-tab active" data-tab="login" onclick="switchAuthTab('login')">Kirish</button>
                <button class="auth-tab" data-tab="register" onclick="switchAuthTab('register')">Ro'yxatdan o'tish</button>
            </div>

            <!-- Login Form -->
            <form id="form-login" class="auth-form" onsubmit="handleLogin(event)">
                <div class="form-group">
                    <div class="input-icon"><i class="fas fa-user"></i></div>
                    <input type="text" id="login-username" placeholder="Foydalanuvchi nomi" required>
                </div>
                <div class="form-group">
                    <div class="input-icon"><i class="fas fa-lock"></i></div>
                    <input type="password" id="login-password" placeholder="Parol" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Rolni tanlang</label>
                    <div class="role-selector">
                        <label class="role-card active" data-role="teacher">
                            <input type="radio" name="login-role" value="teacher" checked>
                            <i class="fas fa-chalkboard-teacher"></i>
                            <span>Ustoz</span>
                        </label>
                        <label class="role-card" data-role="student">
                            <input type="radio" name="login-role" value="student">
                            <i class="fas fa-user-graduate"></i>
                            <span>O'quvchi</span>
                        </label>
                        <label class="role-card" data-role="parent">
                            <input type="radio" name="login-role" value="parent">
                            <i class="fas fa-user-friends"></i>
                            <span>Ota-ona</span>
                        </label>
                    </div>
                </div>
                <button type="submit" class="btn btn-primary btn-block">
                    <i class="fas fa-sign-in-alt"></i> Kirish
                </button>
            </form>

            <!-- Register Form -->
            <form id="form-register" class="auth-form hidden" onsubmit="handleRegister(event)">
                <div class="form-group">
                    <div class="input-icon"><i class="fas fa-user"></i></div>
                    <input type="text" id="reg-fullname" placeholder="To'liq ism" required>
                </div>
                <div class="form-group">
                    <div class="input-icon"><i class="fas fa-at"></i></div>
                    <input type="text" id="reg-username" placeholder="Foydalanuvchi nomi" required>
                </div>
                <div class="form-group">
                    <div class="input-icon"><i class="fas fa-lock"></i></div>
                    <input type="password" id="reg-password" placeholder="Parol" required>
                </div>
                <div class="form-group">
                    <div class="input-icon"><i class="fas fa-lock"></i></div>
                    <input type="password" id="reg-confirm" placeholder="Parolni tasdiqlang" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Rolni tanlang</label>
                    <div class="role-selector">
                        <label class="role-card active" data-role="teacher">
                            <input type="radio" name="reg-role" value="teacher" checked>
                            <i class="fas fa-chalkboard-teacher"></i>
                            <span>Ustoz</span>
                        </label>
                        <label class="role-card" data-role="student">
                            <input type="radio" name="reg-role" value="student">
                            <i class="fas fa-user-graduate"></i>
                            <span>O'quvchi</span>
                        </label>
                        <label class="role-card" data-role="parent">
                            <input type="radio" name="reg-role" value="parent">
                            <i class="fas fa-user-friends"></i>
                            <span>Ota-ona</span>
                        </label>
                    </div>
                </div>
                <div id="parent-child-field" class="form-group hidden">
                    <div class="input-icon"><i class="fas fa-child"></i></div>
                    <input type="text" id="reg-child-username" placeholder="Farzandingizning username'i">
                </div>
                <button type="submit" class="btn btn-primary btn-block">
                    <i class="fas fa-user-plus"></i> Ro'yxatdan o'tish
                </button>
            </form>
        </div>
    </div>

    <!-- ==================== TEACHER DASHBOARD ==================== -->
    <div id="page-teacher" class="page hidden">
        <div class="app-layout">
            <!-- Sidebar -->
            <aside class="sidebar" id="teacher-sidebar">
                <div class="sidebar-header">
                    <i class="fas fa-square-root-variable"></i>
                    <span>Math<strong>Zone</strong></span>
                    <button class="sidebar-close" onclick="toggleSidebar()"><i class="fas fa-times"></i></button>
                </div>
                <nav class="sidebar-nav">
                    <a class="nav-item active" data-page="teacher-home" onclick="showSection('teacher-home')">
                        <i class="fas fa-home"></i><span>Bosh sahifa</span>
                    </a>
                    <a class="nav-item" data-page="teacher-classes" onclick="showSection('teacher-classes')">
                        <i class="fas fa-users"></i><span>Sinflarim</span>
                    </a>
                    <a class="nav-item" data-page="teacher-create-test" onclick="showSection('teacher-create-test')">
                        <i class="fas fa-plus-circle"></i><span>Test yaratish</span>
                    </a>
                    <a class="nav-item" data-page="teacher-tests" onclick="showSection('teacher-tests')">
                        <i class="fas fa-file-alt"></i><span>Testlarim</span>
                    </a>
                    <a class="nav-item" data-page="teacher-results" onclick="showSection('teacher-results')">
                        <i class="fas fa-poll"></i><span>Natijalar</span>
                    </a>
                    <a class="nav-item" data-page="teacher-analytics" onclick="showSection('teacher-analytics')">
                        <i class="fas fa-chart-bar"></i><span>Statistika</span>
                    </a>
                    <a class="nav-item" data-page="teacher-announcements" onclick="showSection('teacher-announcements')">
                        <i class="fas fa-bullhorn"></i><span>E'lonlar</span>
                    </a>
                    <a class="nav-item" data-page="settings" onclick="showSection('settings')">
                        <i class="fas fa-cog"></i><span>Sozlamalar</span>
                    </a>
                </nav>
                <div class="sidebar-footer">
                    <button class="btn btn-danger btn-sm btn-block" onclick="handleLogout()">
                        <i class="fas fa-sign-out-alt"></i> Chiqish
                    </button>
                </div>
            </aside>

            <!-- Main Content -->
            <main class="main-content">
                <!-- Top Bar -->
                <header class="topbar">
                    <button class="btn-icon hamburger" onclick="toggleSidebar()">
                        <i class="fas fa-bars"></i>
                    </button>
                    <div class="topbar-search">
                        <i class="fas fa-search"></i>
                        <input type="text" placeholder="Qidirish..." id="search-input">
                    </div>
                    <div class="topbar-actions">
                        <button class="btn-icon" onclick="toggleTheme()" title="Mavzu o'zgartirish">
                            <i class="fas fa-moon" id="theme-icon"></i>
                        </button>
                        <button class="btn-icon notif-btn" onclick="toggleNotifications()">
                            <i class="fas fa-bell"></i>
                            <span class="notif-badge hidden" id="notif-badge">0</span>
                        </button>
                        <div class="user-menu" onclick="toggleUserMenu()">
                            <div class="user-avatar" id="user-avatar">U</div>
                            <span class="user-name" id="user-name">Ustoz</span>
                            <i class="fas fa-chevron-down"></i>
                        </div>
                    </div>
                    <!-- Notifications Dropdown -->
                    <div class="notif-dropdown hidden" id="notif-dropdown">
                        <div class="notif-header">
                            <h4>Bildirishnomalar</h4>
                            <button class="btn-link" onclick="markAllRead()">Hammasini o'qish</button>
                        </div>
                        <div class="notif-list" id="notif-list">
                            <p class="notif-empty">Bildirishnomalar yo'q</p>
                        </div>
                    </div>
                </header>

                <!-- Teacher Home -->
                <section id="teacher-home" class="content-section active">
                    <div class="welcome-card">
                        <div class="welcome-text">
                            <h2>Xush kelibsiz, <span id="welcome-name">Ustoz</span>!</h2>
                            <p>Bugun yangi test yarating va o'quvchilaringiz bilimini sinang.</p>
                        </div>
                        <div class="welcome-illustration">
                            <i class="fas fa-chalkboard-teacher"></i>
                        </div>
                    </div>

                    <div class="stats-grid">
                        <div class="stat-card stat-purple">
                            <div class="stat-icon"><i class="fas fa-users"></i></div>
                            <div class="stat-info">
                                <span class="stat-number" id="stat-students">0</span>
                                <span class="stat-label">O'quvchilar</span>
                            </div>
                        </div>
                        <div class="stat-card stat-blue">
                            <div class="stat-icon"><i class="fas fa-file-alt"></i></div>
                            <div class="stat-info">
                                <span class="stat-number" id="stat-tests">0</span>
                                <span class="stat-label">Testlar</span>
                            </div>
                        </div>
                        <div class="stat-card stat-green">
                            <div class="stat-icon"><i class="fas fa-check-circle"></i></div>
                            <div class="stat-info">
                                <span class="stat-number" id="stat-results">0</span>
                                <span class="stat-label">Natijalar</span>
                            </div>
                        </div>
                        <div class="stat-card stat-amber">
                            <div class="stat-icon"><i class="fas fa-star"></i></div>
                            <div class="stat-info">
                                <span class="stat-number" id="stat-avg">0%</span>
                                <span class="stat-label">O'rtacha ball</span>
                            </div>
                        </div>
                    </div>

                    <div class="dashboard-grid">
                        <div class="card chart-card">
                            <h3 class="card-title"><i class="fas fa-chart-line"></i> Natijalar dinamikasi</h3>
                            <canvas id="chart-results-line"></canvas>
                        </div>
                        <div class="card chart-card">
                            <h3 class="card-title"><i class="fas fa-chart-doughnut"></i> Kategoriyalar</h3>
                            <canvas id="chart-category-doughnut"></canvas>
                        </div>
                    </div>

                    <div class="card">
                        <h3 class="card-title"><i class="fas fa-history"></i> So'nggi faoliyat</h3>
                        <div class="activity-feed" id="activity-feed">
                            <p class="empty-state">Hozircha faoliyat yo'q</p>
                        </div>
                    </div>
                </section>

                <!-- Teacher Classes -->
                <section id="teacher-classes" class="content-section hidden">
                    <div class="section-header">
                        <h2><i class="fas fa-users"></i> Sinflarim</h2>
                        <button class="btn btn-primary" onclick="showCreateClass()">
                            <i class="fas fa-plus"></i> Yangi sinf
                        </button>
                    </div>
                    <!-- Create Class Form -->
                    <div id="create-class-form" class="card hidden" style="margin-bottom:24px">
                        <h3 class="card-title">Yangi sinf yaratish</h3>
                        <form onsubmit="createClass(event)">
                            <div class="form-row">
                                <div class="form-group flex-1">
                                    <label>Sinf nomi</label>
                                    <input type="text" id="class-name" placeholder="Masalan: 9-A sinf" required>
                                </div>
                                <div class="form-group flex-1">
                                    <label>Tavsif</label>
                                    <input type="text" id="class-desc" placeholder="Qisqa tavsif">
                                </div>
                            </div>
                            <div class="form-actions">
                                <button type="button" class="btn btn-secondary" onclick="hideCreateClass()">Bekor qilish</button>
                                <button type="submit" class="btn btn-primary"><i class="fas fa-save"></i> Saqlash</button>
                            </div>
                        </form>
                    </div>
                    <div class="classes-grid" id="classes-grid">
                        <p class="empty-state"><i class="fas fa-inbox"></i><br>Hali sinf yaratilmagan</p>
                    </div>
                </section>

                <!-- Test Creator -->
                <section id="teacher-create-test" class="content-section hidden">
                    <div class="section-header">
                        <h2><i class="fas fa-plus-circle"></i> Test yaratish</h2>
                    </div>
                    <form id="test-form" onsubmit="saveTest(event)">
                        <div class="card">
                            <h3 class="card-title">Test ma'lumotlari</h3>
                            <div class="form-row">
                                <div class="form-group flex-2">
                                    <label>Test nomi</label>
                                    <input type="text" id="test-title" placeholder="Masalan: Algebra — 1-nazorat ishi" required>
                                </div>
                                <div class="form-group flex-1">
                                    <label>Sinf</label>
                                    <select id="test-class" required>
                                        <option value="">Tanlang...</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group flex-1">
                                    <label>Kategoriya</label>
                                    <select id="test-category">
                                        <option value="algebra">Algebra</option>
                                        <option value="geometriya">Geometriya</option>
                                        <option value="trigonometriya">Trigonometriya</option>
                                        <option value="arifmetika">Arifmetika</option>
                                        <option value="statistika">Statistika</option>
                                        <option value="analiz">Matematik analiz</option>
                                    </select>
                                </div>
                                <div class="form-group flex-1">
                                    <label>Qiyinlik</label>
                                    <select id="test-difficulty">
                                        <option value="easy">Oson</option>
                                        <option value="medium">O'rta</option>
                                        <option value="hard">Qiyin</option>
                                    </select>
                                </div>
                                <div class="form-group flex-1">
                                    <label>Umumiy vaqt (daqiqa)</label>
                                    <input type="number" id="test-time" value="30" min="1" max="180">
                                </div>
                            </div>
                            <div class="form-row options-row">
                                <label class="toggle-label">
                                    <input type="checkbox" id="test-shuffle"> 
                                    <span class="toggle-switch"></span>
                                    Savollarni aralashtirish
                                </label>
                                <label class="toggle-label">
                                    <input type="checkbox" id="test-fullscreen">
                                    <span class="toggle-switch"></span>
                                    Fullscreen rejim
                                </label>
                                <label class="toggle-label">
                                    <input type="checkbox" id="test-tab-detect">
                                    <span class="toggle-switch"></span>
                                    Tab nazorati
                                </label>
                                <label class="toggle-label">
                                    <input type="checkbox" id="test-retry">
                                    <span class="toggle-switch"></span>
                                    Qayta yechish
                                </label>
                            </div>
                        </div>

                        <!-- PDF Upload -->
                        <div class="card">
                            <h3 class="card-title"><i class="fas fa-file-pdf"></i> PDF yuklash (ixtiyoriy)</h3>
                            <div class="pdf-dropzone" id="pdf-dropzone" ondragover="event.preventDefault()" ondrop="handlePdfDrop(event)">
                                <i class="fas fa-cloud-upload-alt"></i>
                                <p>PDF faylni bu yerga tashlang yoki</p>
                                <label class="btn btn-secondary">
                                    <i class="fas fa-folder-open"></i> Faylni tanlash
                                    <input type="file" accept=".pdf" id="pdf-input" onchange="handlePdfUpload(event)" hidden>
                                </label>
                                <div id="pdf-preview" class="pdf-preview hidden"></div>
                            </div>
                        </div>

                        <!-- Questions -->
                        <div class="card">
                            <div class="section-header" style="margin-bottom:16px">
                                <h3 class="card-title"><i class="fas fa-list-ol"></i> Savollar</h3>
                                <button type="button" class="btn btn-primary" onclick="addQuestion()">
                                    <i class="fas fa-plus"></i> Savol qo'shish
                                </button>
                            </div>
                            <p class="hint-text">LaTeX formulalar uchun <code>$formula$</code> yozing. Masalan: <code>$x^2 + y^2 = r^2$</code></p>
                            <div id="questions-container"></div>
                        </div>

                        <div class="form-actions sticky-actions">
                            <button type="button" class="btn btn-secondary" onclick="saveTestDraft()">
                                <i class="fas fa-save"></i> Qoralama saqlash
                            </button>
                            <button type="submit" class="btn btn-primary btn-lg">
                                <i class="fas fa-paper-plane"></i> Nashr qilish
                            </button>
                        </div>
                    </form>
                </section>

                <!-- Test List -->
                <section id="teacher-tests" class="content-section hidden">
                    <div class="section-header">
                        <h2><i class="fas fa-file-alt"></i> Testlarim</h2>
                        <div class="filter-bar">
                            <select id="filter-category" onchange="filterTests()">
                                <option value="">Barcha kategoriyalar</option>
                                <option value="algebra">Algebra</option>
                                <option value="geometriya">Geometriya</option>
                                <option value="trigonometriya">Trigonometriya</option>
                                <option value="arifmetika">Arifmetika</option>
                                <option value="statistika">Statistika</option>
                            </select>
                            <select id="filter-difficulty" onchange="filterTests()">
                                <option value="">Barcha qiyinlik</option>
                                <option value="easy">Oson</option>
                                <option value="medium">O'rta</option>
                                <option value="hard">Qiyin</option>
                            </select>
                        </div>
                    </div>
                    <div class="tests-grid" id="tests-grid">
                        <p class="empty-state"><i class="fas fa-inbox"></i><br>Hali test yaratilmagan</p>
                    </div>
                </section>

                <!-- Teacher Results -->
                <section id="teacher-results" class="content-section hidden">
                    <div class="section-header">
                        <h2><i class="fas fa-poll"></i> Natijalar</h2>
                        <div class="filter-bar">
                            <select id="result-test-filter" onchange="loadTeacherResults()">
                                <option value="">Test tanlang...</option>
                            </select>
                            <button class="btn btn-secondary" onclick="exportResults()">
                                <i class="fas fa-file-excel"></i> Excel
                            </button>
                        </div>
                    </div>
                    <div class="results-summary hidden" id="results-summary">
                        <div class="stat-card stat-green">
                            <div class="stat-info">
                                <span class="stat-number" id="res-avg">0%</span>
                                <span class="stat-label">O'rtacha</span>
                            </div>
                        </div>
                        <div class="stat-card stat-blue">
                            <div class="stat-info">
                                <span class="stat-number" id="res-max">0%</span>
                                <span class="stat-label">Eng yuqori</span>
                            </div>
                        </div>
                        <div class="stat-card stat-amber">
                            <div class="stat-info">
                                <span class="stat-number" id="res-min">0%</span>
                                <span class="stat-label">Eng past</span>
                            </div>
                        </div>
                        <div class="stat-card stat-purple">
                            <div class="stat-info">
                                <span class="stat-number" id="res-count">0</span>
                                <span class="stat-label">Ishtirokchilar</span>
                            </div>
                        </div>
                    </div>
                    <div class="card">
                        <div class="table-responsive">
                            <table class="data-table" id="results-table">
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>O'quvchi</th>
                                        <th>Ball</th>
                                        <th>Foiz</th>
                                        <th>Baho</th>
                                        <th>Vaqt</th>
                                        <th>Sana</th>
                                    </tr>
                                </thead>
                                <tbody id="results-tbody"></tbody>
                            </table>
                        </div>
                    </div>
                </section>

                <!-- Teacher Analytics -->
                <section id="teacher-analytics" class="content-section hidden">
                    <div class="section-header">
                        <h2><i class="fas fa-chart-bar"></i> Statistika</h2>
                    </div>
                    <div class="analytics-grid">
                        <div class="card chart-card">
                            <h3 class="card-title">Ball taqsimoti</h3>
                            <canvas id="chart-score-dist"></canvas>
                        </div>
                        <div class="card chart-card">
                            <h3 class="card-title">Mavzu bo'yicha natijalar</h3>
                            <canvas id="chart-topic-radar"></canvas>
                        </div>
                        <div class="card chart-card full-width">
                            <h3 class="card-title">Sinf dinamikasi</h3>
                            <canvas id="chart-class-progress"></canvas>
                        </div>
                    </div>
                    <div class="card">
                        <h3 class="card-title"><i class="fas fa-robot"></i> AI Tavsiyalar</h3>
                        <div id="ai-recommendations" class="ai-box">
                            <p class="empty-state">Yetarli ma'lumot yo'q. Testlar o'tkazilgandan so'ng tavsiyalar paydo bo'ladi.</p>
                        </div>
                    </div>
                </section>

                <!-- Announcements -->
                <section id="teacher-announcements" class="content-section hidden">
                    <div class="section-header">
                        <h2><i class="fas fa-bullhorn"></i> E'lonlar</h2>
                        <button class="btn btn-primary" onclick="showAnnouncementForm()">
                            <i class="fas fa-plus"></i> Yangi e'lon
                        </button>
                    </div>
                    <div id="announcement-form" class="card hidden" style="margin-bottom:24px">
                        <form onsubmit="postAnnouncement(event)">
                            <div class="form-group">
                                <label>Sarlavha</label>
                                <input type="text" id="ann-title" required placeholder="E'lon sarlavhasi">
                            </div>
                            <div class="form-group">
                                <label>Matn</label>
                                <textarea id="ann-text" rows="4" required placeholder="E'lon matni..."></textarea>
                            </div>
                            <div class="form-group">
                                <label>Sinf</label>
                                <select id="ann-class">
                                    <option value="all">Barcha sinflar</option>
                                </select>
                            </div>
                            <div class="form-actions">
                                <button type="button" class="btn btn-secondary" onclick="hideAnnouncementForm()">Bekor qilish</button>
                                <button type="submit" class="btn btn-primary"><i class="fas fa-paper-plane"></i> Joylash</button>
                            </div>
                        </form>
                    </div>
                    <div id="announcements-list">
                        <p class="empty-state"><i class="fas fa-inbox"></i><br>E'lonlar yo'q</p>
                    </div>
                </section>

                <!-- Settings -->
                <section id="settings" class="content-section hidden">
                    <div class="section-header">
                        <h2><i class="fas fa-cog"></i> Sozlamalar</h2>
                    </div>
                    <div class="card">
                        <h3 class="card-title">Profil</h3>
                        <form onsubmit="updateProfile(event)">
                            <div class="form-row">
                                <div class="form-group flex-1">
                                    <label>To'liq ism</label>
                                    <input type="text" id="settings-name">
                                </div>
                                <div class="form-group flex-1">
                                    <label>Username</label>
                                    <input type="text" id="settings-username" disabled>
                                </div>
                            </div>
                            <button type="submit" class="btn btn-primary"><i class="fas fa-save"></i> Saqlash</button>
                        </form>
                    </div>
                    <div class="card">
                        <h3 class="card-title">Interfeys</h3>
                        <label class="toggle-label">
                            <input type="checkbox" id="settings-darkmode" onchange="toggleTheme()">
                            <span class="toggle-switch"></span>
                            Qorong'u rejim
                        </label>
                    </div>
                </section>
            </main>
        </div>
    </div>

    <!-- ==================== STUDENT DASHBOARD ==================== -->
    <div id="page-student" class="page hidden">
        <div class="app-layout">
            <aside class="sidebar" id="student-sidebar">
                <div class="sidebar-header">
                    <i class="fas fa-square-root-variable"></i>
                    <span>Math<strong>Zone</strong></span>
                    <button class="sidebar-close" onclick="toggleSidebar()"><i class="fas fa-times"></i></button>
                </div>
                <nav class="sidebar-nav">
                    <a class="nav-item active" data-page="student-home" onclick="showSection('student-home')">
                        <i class="fas fa-home"></i><span>Bosh sahifa</span>
                    </a>
                    <a class="nav-item" data-page="student-join" onclick="showSection('student-join')">
                        <i class="fas fa-sign-in-alt"></i><span>Sinfga qo'shilish</span>
                    </a>
                    <a class="nav-item" data-page="student-tests" onclick="showSection('student-tests')">
                        <i class="fas fa-file-alt"></i><span>Testlar</span>
                    </a>
                    <a class="nav-item" data-page="student-results" onclick="showSection('student-results')">
                        <i class="fas fa-poll"></i><span>Natijalarim</span>
                    </a>
                    <a class="nav-item" data-page="student-leaderboard" onclick="showSection('student-leaderboard')">
                        <i class="fas fa-trophy"></i><span>Reyting</span>
                    </a>
                    <a class="nav-item" data-page="student-achievements" onclick="showSection('student-achievements')">
                        <i class="fas fa-medal"></i><span>Yutuqlarim</span>
                    </a>
                    <a class="nav-item" data-page="student-formulas" onclick="showSection('student-formulas')">
                        <i class="fas fa-square-root-variable"></i><span>Formulalar</span>
                    </a>
                    <a class="nav-item" data-page="student-practice" onclick="showSection('student-practice')">
                        <i class="fas fa-dumbbell"></i><span>Mashq rejimi</span>
                    </a>
                    <a class="nav-item" data-page="settings" onclick="showSection('settings')">
                        <i class="fas fa-cog"></i><span>Sozlamalar</span>
                    </a>
                </nav>
                <div class="sidebar-footer">
                    <button class="btn btn-danger btn-sm btn-block" onclick="handleLogout()">
                        <i class="fas fa-sign-out-alt"></i> Chiqish
                    </button>
                </div>
            </aside>

            <main class="main-content">
                <header class="topbar">
                    <button class="btn-icon hamburger" onclick="toggleSidebar()">
                        <i class="fas fa-bars"></i>
                    </button>
                    <div class="student-xp-bar-top">
                        <div class="xp-level-badge" id="student-level-badge">1</div>
                        <div class="xp-bar-mini">
                            <div class="xp-bar-fill" id="student-xp-fill" style="width:0%"></div>
                        </div>
                        <span class="xp-text" id="student-xp-text">0 XP</span>
                    </div>
                    <div class="topbar-actions">
                        <div class="streak-display" id="streak-display">
                            <i class="fas fa-fire"></i>
                            <span id="streak-count">0</span>
                        </div>
                        <button class="btn-icon" onclick="toggleTheme()">
                            <i class="fas fa-moon"></i>
                        </button>
                        <button class="btn-icon notif-btn" onclick="toggleNotifications()">
                            <i class="fas fa-bell"></i>
                            <span class="notif-badge hidden" id="student-notif-badge">0</span>
                        </button>
                        <div class="user-menu" onclick="toggleUserMenu()">
                            <div class="user-avatar" id="student-avatar">O</div>
                            <span class="user-name" id="student-name">O'quvchi</span>
                        </div>
                    </div>
                    <div class="notif-dropdown hidden" id="student-notif-dropdown">
                        <div class="notif-header">
                            <h4>Bildirishnomalar</h4>
                            <button class="btn-link" onclick="markAllRead()">Hammasini o'qish</button>
                        </div>
                        <div class="notif-list" id="student-notif-list"></div>
                    </div>
                </header>

                <!-- Student Home -->
                <section id="student-home" class="content-section active">
                    <div class="welcome-card student-welcome">
                        <div class="welcome-text">
                            <h2>Salom, <span id="student-welcome-name">O'quvchi</span>!</h2>
                            <p>Bugun ham bilimingizni oshiring va yangi cho'qqilarni zabt eting!</p>
                        </div>
                        <div class="welcome-stats-mini">
                            <div class="mini-stat">
                                <i class="fas fa-fire fire-icon"></i>
                                <span id="home-streak">0 kun</span>
                            </div>
                            <div class="mini-stat">
                                <i class="fas fa-star star-icon"></i>
                                <span id="home-level">Daraja 1</span>
                            </div>
                        </div>
                    </div>

                    <div class="stats-grid">
                        <div class="stat-card stat-purple">
                            <div class="stat-icon"><i class="fas fa-check-circle"></i></div>
                            <div class="stat-info">
                                <span class="stat-number" id="s-stat-tests">0</span>
                                <span class="stat-label">Yechilgan testlar</span>
                            </div>
                        </div>
                        <div class="stat-card stat-blue">
                            <div class="stat-icon"><i class="fas fa-percentage"></i></div>
                            <div class="stat-info">
                                <span class="stat-number" id="s-stat-avg">0%</span>
                                <span class="stat-label">O'rtacha ball</span>
                            </div>
                        </div>
                        <div class="stat-card stat-green">
                            <div class="stat-icon"><i class="fas fa-trophy"></i></div>
                            <div class="stat-info">
                                <span class="stat-number" id="s-stat-rank">#-</span>
                                <span class="stat-label">Reyting</span>
                            </div>
                        </div>
                        <div class="stat-card stat-amber">
                            <div class="stat-icon"><i class="fas fa-gem"></i></div>
                            <div class="stat-info">
                                <span class="stat-number" id="s-stat-xp">0</span>
                                <span class="stat-label">Jami XP</span>
                            </div>
                        </div>
                    </div>

                    <div class="dashboard-grid">
                        <div class="card">
                            <h3 class="card-title"><i class="fas fa-file-alt"></i> Mavjud testlar</h3>
                            <div id="available-tests-list">
                                <p class="empty-state">Hozircha testlar yo'q</p>
                            </div>
                        </div>
                        <div class="card chart-card">
                            <h3 class="card-title"><i class="fas fa-chart-line"></i> Progressim</h3>
                            <canvas id="chart-student-progress"></canvas>
                        </div>
                    </div>

                    <div class="card">
                        <h3 class="card-title"><i class="fas fa-medal"></i> So'nggi yutuqlar</h3>
                        <div class="achievements-mini" id="achievements-mini">
                            <p class="empty-state">Hali yutuqlar yo'q. Test yechib boshlang!</p>
                        </div>
                    </div>
                </section>

                <!-- Join Class -->
                <section id="student-join" class="content-section hidden">
                    <div class="section-header">
                        <h2><i class="fas fa-sign-in-alt"></i> Sinfga qo'shilish</h2>
                    </div>
                    <div class="card" style="max-width:500px">
                        <form onsubmit="joinClass(event)">
                            <div class="form-group">
                                <label>Sinf kodi</label>
                                <input type="text" id="join-class-code" placeholder="6 xonali kodni kiriting" maxlength="6" style="text-transform:uppercase;font-size:1.5rem;text-align:center;letter-spacing:8px" required>
                            </div>
                            <button type="submit" class="btn btn-primary btn-block btn-lg">
                                <i class="fas fa-sign-in-alt"></i> Qo'shilish
                            </button>
                        </form>
                    </div>
                    <div class="card" style="margin-top:24px">
                        <h3 class="card-title">Mening sinflarim</h3>
                        <div id="student-classes-list">
                            <p class="empty-state">Hali hech qanday sinfga qo'shilmagansiz</p>
                        </div>
                    </div>
                </section>

                <!-- Student Tests -->
                <section id="student-tests" class="content-section hidden">
                    <div class="section-header">
                        <h2><i class="fas fa-file-alt"></i> Testlar</h2>
                    </div>
                    <div class="tests-grid" id="student-tests-grid">
                        <p class="empty-state"><i class="fas fa-inbox"></i><br>Hozircha testlar yo'q</p>
                    </div>
                </section>

                <!-- Student Results -->
                <section id="student-results" class="content-section hidden">
                    <div class="section-header">
                        <h2><i class="fas fa-poll"></i> Natijalarim</h2>
                    </div>
                    <div id="student-results-list">
                        <p class="empty-state"><i class="fas fa-inbox"></i><br>Hali test yechilmagan</p>
                    </div>
                </section>

                <!-- Leaderboard -->
                <section id="student-leaderboard" class="content-section hidden">
                    <div class="section-header">
                        <h2><i class="fas fa-trophy"></i> Reyting</h2>
                        <div class="filter-bar">
                            <select id="lb-period" onchange="loadLeaderboard()">
                                <option value="all">Hammasi</option>
                                <option value="month">Bu oy</option>
                                <option value="week">Bu hafta</option>
                            </select>
                        </div>
                    </div>
                    <div class="podium" id="podium">
                        <div class="podium-place second">
                            <div class="podium-avatar" id="pod-2-avatar">?</div>
                            <div class="podium-name" id="pod-2-name">—</div>
                            <div class="podium-score" id="pod-2-score">0 XP</div>
                            <div class="podium-bar"><span>2</span></div>
                        </div>
                        <div class="podium-place first">
                            <i class="fas fa-crown podium-crown"></i>
                            <div class="podium-avatar" id="pod-1-avatar">?</div>
                            <div class="podium-name" id="pod-1-name">—</div>
                            <div class="podium-score" id="pod-1-score">0 XP</div>
                            <div class="podium-bar"><span>1</span></div>
                        </div>
                        <div class="podium-place third">
                            <div class="podium-avatar" id="pod-3-avatar">?</div>
                            <div class="podium-name" id="pod-3-name">—</div>
                            <div class="podium-score" id="pod-3-score">0 XP</div>
                            <div class="podium-bar"><span>3</span></div>
                        </div>
                    </div>
                    <div class="card">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>O'quvchi</th>
                                    <th>XP</th>
                                    <th>Testlar</th>
                                    <th>O'rtacha</th>
                                    <th>Daraja</th>
                                </tr>
                            </thead>
                            <tbody id="leaderboard-tbody"></tbody>
                        </table>
                    </div>
                </section>

                <!-- Achievements -->
                <section id="student-achievements" class="content-section hidden">
                    <div class="section-header">
                        <h2><i class="fas fa-medal"></i> Yutuqlarim</h2>
                    </div>
                    <div class="achievements-grid" id="achievements-grid"></div>
                </section>

                <!-- Formulas -->
                <section id="student-formulas" class="content-section hidden">
                    <div class="section-header">
                        <h2><i class="fas fa-square-root-variable"></i> Formulalar bazasi</h2>
                        <div class="filter-bar">
                            <select id="formula-category" onchange="filterFormulas()">
                                <option value="">Barchasi</option>
                                <option value="algebra">Algebra</option>
                                <option value="geometriya">Geometriya</option>
                                <option value="trigonometriya">Trigonometriya</option>
                            </select>
                            <input type="text" placeholder="Qidirish..." id="formula-search" oninput="filterFormulas()">
                        </div>
                    </div>
                    <div class="formulas-grid" id="formulas-grid"></div>
                </section>

                <!-- Practice Mode -->
                <section id="student-practice" class="content-section hidden">
                    <div class="section-header">
                        <h2><i class="fas fa-dumbbell"></i> Mashq rejimi</h2>
                    </div>
                    <div class="card" style="max-width:600px">
                        <div class="form-row">
                            <div class="form-group flex-1">
                                <label>Mavzu</label>
                                <select id="practice-topic">
                                    <option value="algebra">Algebra</option>
                                    <option value="geometriya">Geometriya</option>
                                    <option value="trigonometriya">Trigonometriya</option>
                                    <option value="arifmetika">Arifmetika</option>
                                </select>
                            </div>
                            <div class="form-group flex-1">
                                <label>Qiyinlik</label>
                                <select id="practice-diff">
                                    <option value="easy">Oson</option>
                                    <option value="medium">O'rta</option>
                                    <option value="hard">Qiyin</option>
                                </select>
                            </div>
                        </div>
                        <button class="btn btn-primary btn-block btn-lg" onclick="startPractice()">
                            <i class="fas fa-play"></i> Mashqni boshlash
                        </button>
                    </div>
                    <div id="practice-area" class="hidden" style="margin-top:24px">
                        <div class="card practice-card">
                            <div class="practice-header">
                                <span class="badge" id="practice-counter">Savol 1</span>
                                <span class="badge badge-info" id="practice-score-display">To'g'ri: 0 | Noto'g'ri: 0</span>
                            </div>
                            <div class="practice-question" id="practice-question"></div>
                            <div class="practice-options" id="practice-options"></div>
                            <div class="practice-feedback hidden" id="practice-feedback"></div>
                            <div class="practice-actions">
                                <button class="btn btn-secondary" id="practice-hint-btn" onclick="showPracticeHint()">
                                    <i class="fas fa-lightbulb"></i> Yordam
                                </button>
                                <button class="btn btn-primary" id="practice-next-btn" onclick="nextPracticeQuestion()" disabled>
                                    Keyingi <i class="fas fa-arrow-right"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </section>
            </main>
        </div>

        <!-- Mobile Bottom Nav -->
        <nav class="mobile-bottom-nav">
            <a class="bottom-nav-item active" onclick="showSection('student-home')">
                <i class="fas fa-home"></i><span>Bosh sahifa</span>
            </a>
            <a class="bottom-nav-item" onclick="showSection('student-tests')">
                <i class="fas fa-file-alt"></i><span>Testlar</span>
            </a>
            <a class="bottom-nav-item" onclick="showSection('student-leaderboard')">
                <i class="fas fa-trophy"></i><span>Reyting</span>
            </a>
            <a class="bottom-nav-item" onclick="showSection('student-achievements')">
                <i class="fas fa-medal"></i><span>Yutuqlar</span>
            </a>
            <a class="bottom-nav-item" onclick="showSection('settings')">
                <i class="fas fa-cog"></i><span>Sozlama</span>
            </a>
        </nav>
    </div>

    <!-- ==================== PARENT DASHBOARD ==================== -->
    <div id="page-parent" class="page hidden">
        <div class="app-layout">
            <aside class="sidebar" id="parent-sidebar">
                <div class="sidebar-header">
                    <i class="fas fa-square-root-variable"></i>
                    <span>Math<strong>Zone</strong></span>
                    <button class="sidebar-close" onclick="toggleSidebar()"><i class="fas fa-times"></i></button>
                </div>
                <nav class="sidebar-nav">
                    <a class="nav-item active" data-page="parent-home" onclick="showSection('parent-home')">
                        <i class="fas fa-home"></i><span>Bosh sahifa</span>
                    </a>
                    <a class="nav-item" data-page="parent-results" onclick="showSection('parent-results')">
                        <i class="fas fa-poll"></i><span>Natijalar</span>
                    </a>
                    <a class="nav-item" data-page="parent-progress" onclick="showSection('parent-progress')">
                        <i class="fas fa-chart-line"></i><span>Progress</span>
                    </a>
                    <a class="nav-item" data-page="settings" onclick="showSection('settings')">
                        <i class="fas fa-cog"></i><span>Sozlamalar</span>
                    </a>
                </nav>
                <div class="sidebar-footer">
                    <button class="btn btn-danger btn-sm btn-block" onclick="handleLogout()">
                        <i class="fas fa-sign-out-alt"></i> Chiqish
                    </button>
                </div>
            </aside>
            <main class="main-content">
                <header class="topbar">
                    <button class="btn-icon hamburger" onclick="toggleSidebar()"><i class="fas fa-bars"></i></button>
                    <h3 style="margin:0">Ota-ona paneli</h3>
                    <div class="topbar-actions">
                        <button class="btn-icon" onclick="toggleTheme()"><i class="fas fa-moon"></i></button>
                        <div class="user-menu" onclick="toggleUserMenu()">
                            <div class="user-avatar" id="parent-avatar">P</div>
                            <span class="user-name" id="parent-name">Ota-ona</span>
                        </div>
                    </div>
                </header>

                <section id="parent-home" class="content-section active">
                    <div class="card">
                        <h3 class="card-title"><i class="fas fa-child"></i> Farzand ma'lumotlari</h3>
                        <div id="child-info" class="child-info-card">
                            <p class="empty-state">Farzandingizni ulang (Sozlamalar → Farzand username'ini kiriting)</p>
                        </div>
                    </div>
                    <div class="stats-grid" id="parent-stats">
                        <div class="stat-card stat-blue">
                            <div class="stat-info">
                                <span class="stat-number" id="p-stat-tests">0</span>
                                <span class="stat-label">Yechilgan testlar</span>
                            </div>
                        </div>
                        <div class="stat-card stat-green">
                            <div class="stat-info">
                                <span class="stat-number" id="p-stat-avg">0%</span>
                                <span class="stat-label">O'rtacha ball</span>
                            </div>
                        </div>
                        <div class="stat-card stat-amber">
                            <div class="stat-info">
                                <span class="stat-number" id="p-stat-streak">0</span>
                                <span class="stat-label">Streak</span>
                            </div>
                        </div>
                    </div>
                    <div class="card">
                        <h3 class="card-title"><i class="fas fa-history"></i> So'nggi natijalar</h3>
                        <div id="parent-recent-results">
                            <p class="empty-state">Natijalar yo'q</p>
                        </div>
                    </div>
                </section>

                <section id="parent-results" class="content-section hidden">
                    <div class="section-header"><h2>Barcha natijalar</h2></div>
                    <div id="parent-all-results" class="card">
                        <p class="empty-state">Natijalar yo'q</p>
                    </div>
                </section>

                <section id="parent-progress" class="content-section hidden">
                    <div class="section-header"><h2>Progress</h2></div>
                    <div class="card chart-card">
                        <canvas id="chart-parent-progress"></canvas>
                    </div>
                </section>
            </main>
        </div>
    </div>

    <!-- ==================== TEST TAKING PAGE ==================== -->
    <div id="page-test-taking" class="page hidden">
        <div class="test-taking-layout">
            <header class="test-topbar">
                <div class="test-info-bar">
                    <h3 id="taking-test-title">Test nomi</h3>
                    <div class="test-timer" id="test-timer">
                        <i class="fas fa-clock"></i>
                        <span id="timer-display">00:00</span>
                    </div>
                </div>
                <div class="test-progress-bar">
                    <div class="test-progress-fill" id="test-progress-fill" style="width:0%"></div>
                </div>
            </header>
            <div class="test-body">
                <div class="test-question-area">
                    <div class="question-number-badge" id="question-number">Savol 1 / 10</div>
                    <div class="question-points" id="question-points">10 ball</div>
                    <div class="question-text" id="question-text"></div>
                    <div class="question-image hidden" id="question-image"></div>
                    <div class="answer-area" id="answer-area"></div>
                    <div class="question-nav-buttons">
                        <button class="btn btn-secondary" id="btn-prev-q" onclick="prevQuestion()">
                            <i class="fas fa-arrow-left"></i> Oldingi
                        </button>
                        <button class="btn btn-secondary flag-btn" id="btn-flag-q" onclick="flagCurrentQuestion()">
                            <i class="fas fa-flag"></i> Belgilash
                        </button>
                        <button class="btn btn-primary" id="btn-next-q" onclick="nextQuestion()">
                            Keyingi <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>
                <div class="test-navigator">
                    <h4>Savollar</h4>
                    <div class="question-grid" id="question-grid"></div>
                    <div class="navigator-legend">
                        <span class="legend-item"><span class="legend-dot answered"></span> Javob berilgan</span>
                        <span class="legend-item"><span class="legend-dot flagged"></span> Belgilangan</span>
                        <span class="legend-item"><span class="legend-dot unanswered"></span> Javob berilmagan</span>
                    </div>
                    <button class="btn btn-primary btn-block" id="btn-submit-test" onclick="submitTestConfirm()">
                        <i class="fas fa-paper-plane"></i> Testni topshirish
                    </button>
                </div>
            </div>
        </div>
        <!-- Tab warning -->
        <div id="tab-warning" class="tab-warning hidden">
            <div class="tab-warning-content">
                <i class="fas fa-exclamation-triangle"></i>
                <h3>Ogohlantirish!</h3>
                <p>Siz boshqa sahifaga o'tdingiz. Bu harakatlar kuzatilmoqda.</p>
                <p>Tab almashtirishlar soni: <strong id="tab-switch-count">0</strong>/3</p>
                <button class="btn btn-primary" onclick="dismissTabWarning()">Tushundim</button>
            </div>
        </div>
    </div>

    <!-- ==================== TEST RESULT PAGE ==================== -->
    <div id="page-test-result" class="page hidden">
        <div class="result-container">
            <div class="result-header">
                <div class="score-circle" id="score-circle">
                    <svg viewBox="0 0 120 120">
                        <circle class="score-bg" cx="60" cy="60" r="54"/>
                        <circle class="score-fill" cx="60" cy="60" r="54" id="score-fill-circle"/>
                    </svg>
                    <div class="score-text">
                        <span class="score-percent" id="result-percent">0%</span>
                    </div>
                </div>
                <div class="result-grade" id="result-grade">A</div>
                <h2 id="result-test-name">Test nomi</h2>
                <div class="result-meta">
                    <span><i class="fas fa-clock"></i> <span id="result-time">0:00</span></span>
                    <span><i class="fas fa-check"></i> <span id="result-correct">0</span> to'g'ri</span>
                    <span><i class="fas fa-times"></i> <span id="result-wrong">0</span> noto'g'ri</span>
                </div>
                <div class="xp-earned-display" id="xp-earned-display">
                    <i class="fas fa-star"></i> +<span id="xp-earned">0</span> XP
                </div>
            </div>

            <div class="result-actions">
                <button class="btn btn-primary" onclick="goToDashboard()">
                    <i class="fas fa-home"></i> Bosh sahifa
                </button>
                <button class="btn btn-secondary" onclick="showDetailedReview()">
                    <i class="fas fa-eye"></i> Batafsil ko'rish
                </button>
            </div>

            <div id="detailed-review" class="hidden">
                <h3 class="card-title" style="margin-top:32px">Batafsil tahlil</h3>
                <div id="review-questions"></div>
            </div>
        </div>
    </div>

    <!-- CDN Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.2/dist/confetti.browser.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/qrcode-generator@1.4.4/qrcode.min.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
